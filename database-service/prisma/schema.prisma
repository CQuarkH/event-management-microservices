generator client {
  provider = "prisma-client-js"
  previewFeatures = ["referentialActions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AttendeeStatus {
  CONFIRMED
  UNCONFIRMED
}

enum TicketType {
  GENERAL
  VIP
}

enum NotificationType {
  EMAIL
  SMS
}

model Event {
  id          String     @id @default(uuid())
  name        String
  date        DateTime
  location    String
  type        String
  description String?
  tickets     Ticket[]   @relation("EventTickets")
  attendees   Attendee[] @relation("EventAttendees")
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model Attendee {
  id        String         @id @default(uuid())
  name      String
  email     String         @unique
  phone     String?
  status    AttendeeStatus @default(UNCONFIRMED)
  event     Event?         @relation("EventAttendees", fields: [eventId], references: [id], onDelete: Cascade)
  eventId   String?
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
}

model Ticket {
  id                String     @id @default(uuid())
  type              TicketType
  price             Float
  quantityAvailable Int
  quantitySold      Int        @default(0)
  event             Event?     @relation("EventTickets", fields: [eventId], references: [id], onDelete: Cascade)
  eventId           String?
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
}

model Notification {
  id         String           @id @default(uuid())
  type       NotificationType
  message    String
  recipients String[]         // Postgres text[]
  sentAt     DateTime?
  createdAt  DateTime         @default(now())
  updatedAt  DateTime         @updatedAt
}
